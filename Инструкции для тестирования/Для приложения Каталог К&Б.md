Привязка вип карты
1. запускаем sql скрипт (в строчку условий вставляем необходимый номер телефона)
 ```sql
SELECT description::jsonb->'userId' as user_id , a.* FROM public.auths_logs AS a
WHERE phone = 79085728301
ORDER BY a.id DESC
```

В результате выводится список, из этого списка нужно взять user_id(самый верхний, т.е самы последний)


2. запускаем следующий скрипт
```sql
select u.* from users u
inner join discount_cards_tie dct on dct.udid_id = u.udid_id
inner join discount_cards dc on dct.card_id = dc.card_id
where dc.privilege is true
and dc.card_id in (
  2020070048069,
  2020120047363,
  2020097016928,
  2020469947379,
  2020070002054,
  2020070050017,
  2020101653545)
  ```

Выводится список.

Альтернатива выше описанному методу назначения Вип прав
## Инструкция для привязки вип карты на устройство пользователя
1. Переходим в таблицу discount_cards
2. В столбце privilege вызываем меню кликом правой кнопкой
3. Выбираем в меню значение "Фильтры", далее выбираем значение prirvilege <>'false'
![[Pasted image 20250724174705.png]]

4. Получаем список
![[Pasted image 20250724175723.png]]
5. В столбец "phone", "phone_normal" вставляем необходимый номер телефона. Нажимаем на кнопку "Save". Из этой таблицы discount_cards, копируем номер дисконтной карты (card_id).
![[Pasted image 20250729133910.png]]

 6. Переходим в таблицу discount_cards_tie
 7. В столбце card_id правой кнопкой мыши вызываем меню. 
     Выбираем в меню значение "Фильтры", далее выбираем значение card_id =
 
 ![[Pasted image 20250728150618.png]]
 
 
 ![[Pasted image 20250728150851.png]]
8. В поле вставляем номер дисконтной карты, которую скопировали (на 5 шаге). Нажимаем на "ОК". Выводится запись.
![[Pasted image 20250728151215.png]]
 9. В поле udid_id нужно вставить запись с udid устройства на которое будет привязана ВИП карта.
 Для этого переходим в таблицу 'auths_logs':
 10. В таблице  'auths_logs', в столбце 'phone' осуществляем поиск номера телефона который привязан к требуемому устройству.
 ![[Pasted image 20250729134317.png]]
 ![[Pasted image 20250729134346.png]]
Получаем список
![[Pasted image 20250729140607.png]]
11. В полученном списке, в столбце "udid_id" выбираем нужное значение, копируем.
12. Возвращаемся к шагу 9. Вставляем скопированный udid_id. Нажимаем кнопку "Save".

Для того чтобы отвязать ВИП карту от устройства:
1. Переходим в таблицу "discount_cards_tie", находим запись по привязанной карте.
![[Pasted image 20250729161121.png]]
2. В столбце "udid_id" отвязываем udid устройства. Нажимаем на кнопку "Save".
![[Pasted image 20250729160604.png]]


udid_id iPhone12,5 - 74805370(61F90A10-41AE-4054-A363-F0CE6978BBFA)

2020104673885, 2020755718614- карты, привязанные к устройству iPhone12,5

2020060202020 - к номеру телефона 79085728301